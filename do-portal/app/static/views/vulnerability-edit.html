<div class="panel panel-primary" ng-cloak>
    <div class="panel-heading">
        <h3 class="panel-title">
            <span ng-show="!vuln">Add</span>
            <span ng-show="vuln">Edit</span>
            vulnerability
        </h3>
    </div>
    <div class="panel-body">
        <div class="row show-grid">
            <div class="col-xs-2">Organization</div>
            <div class="col-xs-10">
                <select class="form-control input-sm"
                        ng-model="vuln.organization_id"
                        ng-options="o.id as o.abbreviation+ ' - ' + o.full_name for o in organizations">
                    <option value="">-- select organization --</option>
                </select>
            </div>

        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Reporter Name</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="Reporter name" ng-model="vuln.reporter_name">
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Reporter email</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="Reporter email" required
                ng-model="vuln.reporter_email">
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Type</div>
            <div class="col-xs-10">
                <ui-select multiple tagging tagging-label="(New type)"
                           ng-model="vuln.types" theme="bootstrap"
                           sortable="true" title="Choose types">
                    <ui-select-match
                            class="ui-select-match"
                            placeholder="Choose types...">{{$item}}
                    </ui-select-match>
                    <ui-select-choices
                            class="ui-select-choices"
                            repeat="tag in tags | filter:$select.search">
                      {{tag}}
                    </ui-select-choices>
                  </ui-select>
            </div>


        </div>

        <div class="row show-grid">
            <div class="col-xs-2">Incident</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="Incident ID" required
                ng-model="vuln.incident_id">
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">PoC</div>
            <div class="col-xs-10">
                <textarea class="form-control" rows="5" ng-model="vuln.url"
                          required placeholder="PoC">
                </textarea>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Method</div>
            <div class="col-xs-10">
                <select class="form-control input-sm" rows="5" ng-model="vuln.request_method">
                  <option value="GET" selected="selected">GET</option>
                  <option value="POST">POST</option>
                </select>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">POST DATA</div>
            <div class="col-xs-10">
                <textarea class="form-control" rows="5" ng-model="vuln.request_data"
                          required placeholder="keep empty if GET request">
                </textarea>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Check string</div>
            <div class="col-xs-10">
                <textarea class="form-control" rows="5" ng-model="vuln.check_string"
                          placeholder="Check string">
                </textarea>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Notes</div>
            <div class="col-xs-10">
                <textarea class="form-control" rows="5" ng-model="vuln.notes"
                           placeholder="notes">
                </textarea>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Scanable</div>
            <div class="col-xs-2">
                <ui-switch ng-model="vuln.scanable" checked></ui-switch>
            </div>
            <div class="col-xs-2">
                <span ng-show="vuln.scanable">
                  The vulnerability will be scanned.
                </span>
                <span ng-show="!vuln.scanable">
                  The vulnerability will NOT be scanned.
                </span>
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Reported</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="reported" required
                ng-model="vuln.reported" disabled="disabled">
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Last Test</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="reported" required
                ng-model="vuln.tested" disabled="disabled">
            </div>
        </div>
        <div class="row show-grid">
            <div class="col-xs-2">Patched</div>
            <div class="col-xs-10">
                <input type="text" class="form-control input-sm"
                placeholder="reported" required
                ng-model="vuln.patched" disabled="disabled">
            </div>
        </div>
    </div>

    <div class="panel-footer">
        <button class="btn btn-default" ng-click="save(vuln)">
            <span class="glyphicon glyphicon-floppy-disk"
                              aria-hidden="true"></span>
            Save
        </button>
        <button class="btn btn-default" ng-click="cancel()">Cancel</button>
    </div>
</div>
